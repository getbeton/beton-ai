# Commit 2.1: Integrate Drag-and-Drop Library

## Goal
Implement react-dropzone integration as shown in the code snippet, including the `FileUploadDropzone` wrapper component

## Dependencies
None (can work in parallel with Phase 1)

## Files Modified
- `frontend/package.json` (add react-dropzone dependency)
- `frontend/src/components/upload/FileUploadDropzone.tsx` (new - extracted from snippet)
- `frontend/src/components/tables/TableDashboard.tsx` (integrate dropzone wrapper)

## Implementation Steps

### Step 1: Install Dependencies
```bash
cd frontend
npm install react-dropzone
npm install @types/react-dropzone --save-dev
# framer-motion already used in snippet for animations
npm install framer-motion
```

### Step 2: Create FileUploadDropzone Wrapper Component
```tsx
// Extract from code snippet:
const FileUploadDropzone: React.FC<{
  onFileUpload: (files: File[]) => void;
  isDragActive: boolean;
  children: React.ReactNode;
}> = ({ onFileUpload, isDragActive, children }) => {
  const { getRootProps, getInputProps } = useDropzone({
    accept: {
      "text/csv": [".csv"],
    },
    multiple: false,
    onDrop: onFileUpload,
  });
  // Global drag overlay implementation
};
```

### Step 3: Implement Drop Zone Configuration
```tsx
// Dropzone configuration from snippet:
accept: { "text/csv": [".csv"] }    // Only CSV files
multiple: false                      // Single file upload
onDrop: onFileUpload                // Callback function
// Visual feedback for drag states
```

### Step 4: Add Global Drag Overlay
```tsx
// From code snippet - when isDragActive:
<div className="absolute inset-0 bg-blue-50/90 border-2 border-dashed border-blue-300 rounded-lg flex items-center justify-center z-10">
  <div className="text-center">
    <Upload className="mx-auto h-12 w-12 text-blue-500 mb-2" />
    <p className="text-lg font-medium text-blue-700">Drop CSV file here</p>
  </div>
</div>
```

### Step 5: Integrate with EmptyState Component
```tsx
// EmptyState already has dropzone integration:
const { getRootProps, getInputProps, isDragActive } = useDropzone({
  accept: { "text/csv": [".csv"] },
  multiple: false,
  onDrop: onFileUpload,
});

// Apply to container div with conditional styling
```

### Step 6: Wrap TableDashboard with FileUploadDropzone
```tsx
// Main component structure from snippet:
return (
  <FileUploadDropzone onFileUpload={handleFileUpload} isDragActive={false}>
    <div className="min-h-screen bg-background p-4 sm:p-6">
      {/* Table dashboard content */}
    </div>
  </FileUploadDropzone>
);
```

### Step 7: Add File Validation Logic
```tsx
// File validation in handleFileUpload:
if (files.length === 0) return;

const file = files[0];
if (!file.name.endsWith(".csv")) {
  alert("Please upload a CSV file");
  return;
}
// Additional size validation if needed
```

## Acceptance Criteria

✅ **Library Integration**: react-dropzone successfully installed and configured
✅ **CSV Only**: Only accepts CSV files with proper validation
✅ **Visual Feedback**: Drag overlay shows "Drop CSV file here" message
✅ **Single File**: Enforces single file upload restriction
✅ **Global Drop Zone**: Works across entire dashboard area when active
✅ **Error Handling**: Clear error messages for invalid file types

## QA Testing Checklist

### Drag-and-Drop Functionality
- [ ] Drag CSV file over dashboard → blue overlay appears
- [ ] Drop CSV file → onFileUpload callback fires with file
- [ ] Drag non-CSV file → still shows overlay (validation happens in callback)
- [ ] Drop non-CSV file → shows "Please upload a CSV file" alert

### File Validation
- [ ] CSV files with .csv extension accepted
- [ ] Files without .csv extension rejected with error message
- [ ] Multiple files dropped → only first file processed
- [ ] Empty file array handled gracefully

### Visual States
- [ ] Default state: no visual indication of drop zone
- [ ] Drag-over state: blue overlay with upload icon and message
- [ ] Drop zone overlay covers entire dashboard area
- [ ] Overlay disappears immediately after drop

### Integration Testing
- [ ] FileUploadDropzone wraps TableDashboard without layout issues
- [ ] EmptyState has its own dropzone for direct interaction
- [ ] Both dropzones use same file validation logic
- [ ] No conflicts between nested dropzones

### Browser Compatibility
- [ ] Works in Chrome (latest)
- [ ] Works in Firefox (latest)
- [ ] Works in Safari (latest)
- [ ] Works in Edge (latest)
- [ ] Mobile browser support (touch devices)

### Error Handling
- [ ] Invalid file type shows alert message
- [ ] File reading errors handled gracefully
- [ ] Network issues don't break dropzone
- [ ] Multiple rapid drops handled correctly

## Code Integration Requirements

### Required Dependencies
```json
// package.json additions:
{
  "dependencies": {
    "react-dropzone": "^14.2.3",
    "framer-motion": "^10.16.4"
  },
  "devDependencies": {
    "@types/react-dropzone": "^5.1.0"
  }
}
```

### Component Structure
```tsx
// Component hierarchy:
TableDashboard
├── FileUploadDropzone (global drop zone)
│   └── Dashboard content
└── EmptyState (local drop zone when no tables)
```

### TypeScript Interfaces
```tsx
interface FileUploadDropzoneProps {
  onFileUpload: (files: File[]) => void;
  isDragActive: boolean;
  children: React.ReactNode;
}

// File callback interface
type FileUploadHandler = (files: File[]) => void;
```

### Animation Integration
```tsx
// Uses framer-motion for overlay animations:
<motion.div
  initial={{ opacity: 0 }}
  animate={{ opacity: 1 }}
  exit={{ opacity: 0 }}
  // Smooth transitions for drag overlay
/>
```

## Definition of Done
- [ ] react-dropzone library installed and configured
- [ ] FileUploadDropzone wrapper component created
- [ ] CSV file validation working
- [ ] Visual drag feedback implemented
- [ ] Global dropzone integrated with dashboard
- [ ] EmptyState dropzone integration maintained
- [ ] Browser compatibility verified
- [ ] Ready for commit 2.2 (backend connection) 